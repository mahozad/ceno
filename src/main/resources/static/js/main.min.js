var body=$("body");var primaryColor=$("html").css("--primary-color");if(typeof(Storage)!=="undefined"){if(localStorage.cookieMessage!=="shown"){var pagePromptElement=$(".page-prompt");if(pagePromptElement.length){pagePromptElement.remove()}$("main").prepend('<div class="page-prompt">  <div class="page-prompt-text">Ceno uses cookies to provide the best browsing experience for you</div></div>')}localStorage.cookieMessage="shown"}$(window).on("load",function(){$("body").removeClass("preload")});var closeBtn=$(".close");var loginDialog=$("#login-dialog");var loginWrapper=$("#login-wrapper");var registerWrapper=$("#register-wrapper");$("#log-in").click(function(){showModal(loginWrapper,registerWrapper)});$("#sign-up").click(function(){showModal(registerWrapper,loginWrapper)});function showModal(a,b){b.hide();loginDialog.show();a.slideDown(350)}$(window).add(closeBtn).click(function(a){if(a.target===loginDialog[0]||a.target===closeBtn[0]){loginDialog.fadeOut(200,function(){registerWrapper.hide();loginWrapper.hide();emptyInput(usernameInput);emptyInput(passwordInput);emptyInput(usernameInputLogin);emptyInput(passwordInputLogin)})}});function emptyInput(a){a.val("");a.siblings(".highlight").hide();a.siblings(".highlight").css("background",primaryColor);a.siblings(".prompt").hide()}$(".log-prompt").click(function(){$(".log-form>div").animate({height:"toggle",opacity:"toggle"},450)});$(".wrt-comment button").on("click touch",function(){var a=$(this).siblings("input").val();var c=$(this).siblings("textarea");var d=c.val();var b=$(".usr-name").text();if(d.length===0){return}$.post("/posts/comments/add",{postId:a,comment:d},function(){var e=$(".comments p");e.text("Comments ("+(+e.text().match(/\d+/)+1)+"):");e.after("<div class='comment'>\n    <div class='comment-author'>\n        <img src='/users/avatars/"+b+"' alt='"+b+"'>\n        <div class='com-auth-name'>"+b+"</div>\n    </div>\n    <div class='comment-text'>"+d+"</div>\n</div>");c.val("");$(".comm-count span").text(+$(".comm-count span").text().match(/\d+/)+1)})});var sliceNumber=1;var hasNext=true;if($(location).attr("pathname").match("^/categories")){var category=$(location).attr("pathname").replace("/categories/","");$(window).scroll(function(){if(hasNext&&$(window).scrollTop()+$(window).height()>$(document).height()-50){$.get("/categories/"+category+"/slice",{sliceNumber:sliceNumber},function(a){if(a===""){$("#spinner").hide();hasNext=false}$(".card:last-child").after(a)});sliceNumber++}})}$(".avatar-upload input").on("change",function(){if(this.files&&this.files[0]){var a=new FileReader();a.onload=function(b){$(".avatar-upload img").attr("src",b.target.result)};a.readAsDataURL(this.files[0])}});$(".post-file input").on("change",function(){if(this.files&&this.files[0]){var a=new FileReader();a.onload=function(b){$(".file-prev").attr("src",b.target.result)};a.readAsDataURL(this.files[0])}});body.on("click touch",".heart",function(){var b=$(this).siblings(".like-num");var a=$(this).parents(".card,.article-container").attr("data-post-id");if($(this).hasClass("liked")){$(this).toggleClass("liked not-liked");$(this).removeClass("animating");like(a,false,b,-1)}else{$(this).addClass("animating");like(a,true,b,+1)}});function like(a,c,b,d){$.post("/posts/like",{postId:a,like:c},function(){b.text(+b.text()+d)})}body.on("animationend",".heart",function(){$(this).toggleClass("not-liked liked")});$(".hamburger-icon").click(function(){$(".side-nav").css({width:"240px","max-width":"100%"})});$(".close-cat").click(function(){$(".side-nav").css("width","0")});body.on("click",".share-icon",function(){var a=$(this).next();if(a.css("visibility")==="visible"){$(this).css("fill","#919da5");a.css({opacity:"0",visibility:"hidden",transform:"translate(-20px, 0)"})}else{$(this).css("fill",primaryColor);a.css({opacity:"1",visibility:"visible",transform:"translate(-20px, 10px)"})}});$(window).click(function(a){if(a.target.tagName!=="svg"&&a.target.tagName!=="path"){$(".share-content").each(function(){if($(this).is(":visible")){$(this).siblings(".share-icon").css("fill","#919da5");$(this).css({opacity:"0",visibility:"hidden",transform:"translate(-20px, 0)"})}})}});var usernameInput=$(".register-form .input:nth-child(1) input");var passwordInput=$(".register-form .input:nth-child(2) input");var passRegex=/((?=.*\d)(?=.*\p{L}))./;$(".flat-inp").focus(function(){var a=$(this).val();if(a===""){$(this).siblings(".highlight").fadeTo(180,1)}});function checkUserName(b,a){$.post("/users/check-username",{name:b},function(c){if(c){a.css("background","#de1e26");a.fadeTo(200,1);usernameInput.siblings(".prompt").text("Already taken");usernameInput.siblings(".prompt").fadeTo(200,1)}else{a.css("background","#4CAF50");a.fadeTo(200,1);usernameInput.siblings(".prompt").fadeTo(200,0)}})}usernameInput.blur(function(){var b=usernameInput.val();var a=usernameInput.siblings(".highlight");if(b===""){a.fadeTo(200,0,function(){a.css("background",primaryColor)});usernameInput.siblings(".prompt").fadeTo(200,0)}else{checkUserName(b,a)}});passwordInput.blur(function(){var b=passwordInput.val();var a=passwordInput.siblings(".highlight");if(b.length===0){a.fadeTo(180,0,function(){a.css("background",primaryColor)});passwordInput.siblings(".prompt").fadeTo(200,0)}else{if(b.length<6||!passRegex.test(b)){a.fadeTo(200,1);a.css("background","#de1e26");if(b.length<6){passwordInput.siblings(".prompt").text("Too short")}else{passwordInput.siblings(".prompt").text("Invalid")}passwordInput.siblings(".prompt").fadeTo(200,1)}else{a.fadeTo(200,1);a.css("background","#4CAF50");passwordInput.siblings(".prompt").fadeTo(200,0)}}});$(".register-form").submit(function(){var e=true;var b=usernameInput.val();var d=passwordInput.val();var a=usernameInput.siblings(".highlight");var c=passwordInput.siblings(".highlight");if(b.length===0){a.css("background","#de1e26");a.fadeTo(200,1);usernameInput.siblings(".prompt").text("Required");usernameInput.siblings(".prompt").fadeTo(200,1);e=false}if(d.length===0){c.css("background","#de1e26");c.fadeTo(200,1);passwordInput.siblings(".prompt").text("Required");passwordInput.siblings(".prompt").fadeTo(200,1);e=false}else{if(!passRegex.test(d)){c.css("background","#de1e26");c.fadeTo(200,1);passwordInput.siblings(".prompt").text("Invalid");passwordInput.siblings(".prompt").fadeTo(200,1);e=false}}return e});var token=$("meta[name='_csrf']").attr("content");var header=$("meta[name='_csrf_header']").attr("content");$(document).ajaxSend(function(a,b){b.setRequestHeader(header,token)});var usernameInputLogin=$(".login-form .input:nth-child(1) input");var passwordInputLogin=$(".login-form .input:nth-child(2) input");usernameInputLogin.blur(function(){var b=usernameInputLogin.val();var a=usernameInputLogin.siblings(".highlight");if(b.length===0){a.fadeTo(200,0,function(){a.css("background",primaryColor)});usernameInputLogin.siblings(".prompt").fadeTo(200,0)}});passwordInputLogin.blur(function(){var b=passwordInputLogin.val();var a=passwordInputLogin.siblings(".highlight");if(b.length===0){a.fadeTo(200,0,function(){a.css("background",primaryColor)});passwordInputLogin.siblings(".prompt").fadeTo(200,0)}});$(".login-form button").on("click touch",function(){var e=true;var b=usernameInputLogin.val();var d=passwordInputLogin.val();var f=$("input[name=remember-me]").prop("checked");var a=usernameInputLogin.siblings(".highlight");var c=passwordInputLogin.siblings(".highlight");if(b.length===0){a.css("background","#de1e26");a.fadeTo(200,1);usernameInputLogin.siblings(".prompt").text("Required");usernameInputLogin.siblings(".prompt").fadeTo(200,1);e=false}if(d.length===0){c.css("background","#de1e26");c.fadeTo(200,1);passwordInputLogin.siblings(".prompt").text("Required");passwordInputLogin.siblings(".prompt").fadeTo(200,1);e=false}if(e){$.post("/login",{username:b,password:d,rememberMe:f},function(g){if(g){location.reload()}else{$(".invalid-login").fadeTo(200,1)}})}});$(".logout").on("click touch",function(){$(this).parent().submit()});body.on("click touch",".ply-btn",function(){var b=$(this).siblings("video")[0];var a=$(this);if(b.paused){b.play();setTimeout(function(){if(!a.is(":hover")){a.fadeTo(200,0)}},1000)}else{b.pause();$(this).fadeTo(80,1)}});body.on("mouseover",".ply-btn",function(){$(this).fadeTo(60,1)});body.on("mouseleave",".ply-btn",function(){$(this).fadeTo(60,1);var a=$(this);var b=$(this).siblings("video")[0];if(!b.paused){setTimeout(function(){if(!a.is(":hover")){a.fadeTo(80,0)}},300)}});body.on("click touch",".ply-btn",function(){$(this).find(".ply-ico").toggleClass("ply-ico-active")});document.addEventListener("timeupdate",function(d){var b=$(d.target);var c=b.siblings("progress");var a=b[0].currentTime/b[0].duration*100;c.stop().animate({value:a},(a===0)?100:400)},true);$("#post-submit").submit(function(){var a=true;$(".input-np").each(function(){var c=$(this).find("input, textarea").val();if(c.length===0){var b=$(this).find(".highlight-np");b.css("background","#de1e26");b.fadeTo(200,1);$(this).find(".prompt").fadeTo(200,1);a=false}});return a});$(".input-np").on("change",function(){var b=$(this).find("input, textarea").val();if(b.length!==0){var a=$(this).find(".highlight-np");a.fadeTo(200,0);$(this).find(".prompt").fadeTo(200,0)}});$(".actions form").submit(function(){return !($(this).find("svg").hasClass("disabled"))});$(".chng-cats-icon").on("click touch",function(){var b=$(".usr-name").text();if(!b){return}var a=$(this).next();if(a.css("visibility")==="visible"){$(this).css("fill","#919da5");a.css({opacity:"0",visibility:"hidden",transform:"translate(-20px, 0)"})}else{$(this).css("fill",primaryColor);a.css({opacity:"1",visibility:"visible",transform:"translate(-20px, 10px)"})}});$(".cat-del-ico").on("click touch",function(){var b=$(".article-container").attr("data-post-id");var a=$(this).siblings(".changeable-cat").text();var c=$(this).parent();$.post("/categories/delete",{postId:b,catName:a},function(){c.remove()})});$(".cat-add-ico").on("click touch",function(){var b=$(".article-container").attr("data-post-id");var a=$(".cat-add-inp").val();$.post("/categories/add",{postId:b,catName:a},function(){$(".cat-del:last-of-type").after('<a class="cat-del"><div class="changeable-cat chip">'+a+'</div><div class="cat-del-ico">&times;</div></a>')})});$(".lang").on("click touch",function(){let searchParams=new URLSearchParams(window.location.search);var a=$(this).attr("data-lang-name");searchParams.set("lang",a);location.replace("?"+searchParams.toString())});$(".theme").on("click touch",function(){let searchParams=new URLSearchParams(window.location.search);var a=$(this).attr("data-theme-name");searchParams.set("theme",a);location.replace("?"+searchParams.toString())});$(document).ready(function(){var b=$("nav .usr-name").text();if(b.length===0){return}var a=new EventSource("/likes/"+b+"/stream");a.onmessage=function(e){var c=JSON.parse(e.data);var d="One of your posts was "+c.message;var f=$(".page-prompt");if(f.length){f.remove()}$("main").prepend('<div class="page-prompt">  <div class="page-prompt-text">'+d+"</div></div>")}});